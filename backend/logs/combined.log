{"level":"info","message":"Email service provider set to SendGrid.","timestamp":"2025-06-28 04:39:44"}
{"level":"warn","message":"Attempt to send email for non-existent or removed Invoice ID: undefined","timestamp":"2025-06-28 04:40:35"}
{"level":"warn","message":"Attempt to send email for non-existent or removed Invoice ID: undefined","timestamp":"2025-06-28 04:40:43"}
{"level":"info","message":"Email service provider set to SendGrid.","timestamp":"2025-06-28 04:42:34"}
{"level":"warn","message":"PDF file not found at expected path: /usr/src/app/public/invoice-685f723f0edc25ba5913651e.pdf for Invoice ID: 685f723f0edc25ba5913651e","timestamp":"2025-06-28 04:42:49"}
{"level":"warn","message":"Email service circuit breaker opened!","timestamp":"2025-06-28 04:42:49"}
{"attempt":1,"error":"Unauthorized","level":"warn","message":"Attempt 1 failed to send email via SendGrid. Retrying...","provider":"SendGrid","subject":"Invoice #1/2025 from Idurar","timestamp":"2025-06-28 04:42:49","to":"sc-2005@yandex.ru"}
{"attempt":2,"error":"Breaker is open","level":"warn","message":"Attempt 2 failed to send email via SendGrid. Retrying...","provider":"SendGrid","subject":"Invoice #1/2025 from Idurar","timestamp":"2025-06-28 04:42:51","to":"sc-2005@yandex.ru"}
{"attempt":3,"error":"Breaker is open","level":"warn","message":"Attempt 3 failed to send email via SendGrid. Retrying...","provider":"SendGrid","subject":"Invoice #1/2025 from Idurar","timestamp":"2025-06-28 04:42:55","to":"sc-2005@yandex.ru"}
{"error":"Breaker is open","level":"error","message":"Fatal error sending email after retries and circuit breaker. Email was not delivered.","provider":"SendGrid","stack":"Error: Breaker is open\n    at buildError (/usr/src/app/node_modules/opossum/lib/circuit.js:1015:17)\n    at CircuitBreaker.call (/usr/src/app/node_modules/opossum/lib/circuit.js:717:21)\n    at CircuitBreaker.fire (/usr/src/app/node_modules/opossum/lib/circuit.js:616:17)\n    at retry.retries (/usr/src/app/src/services/emailService.js:109:21)\n    at RetryOperation.runAttempt [as _fn] (/usr/src/app/node_modules/async-retry/lib/index.js:42:15)\n    at Timeout._onTimeout (/usr/src/app/node_modules/retry/lib/retry_operation.js:85:10)\n    at listOnTimeout (node:internal/timers:581:17)\n    at process.processTimers (node:internal/timers:519:7)","subject":"Invoice #1/2025 from Idurar","timestamp":"2025-06-28 04:43:01","to":"sc-2005@yandex.ru"}
{"error":"Breaker is open","invoiceId":"685f723f0edc25ba5913651e","level":"error","message":"Error in invoice mail controller:","stack":"Error: Breaker is open\n    at buildError (/usr/src/app/node_modules/opossum/lib/circuit.js:1015:17)\n    at CircuitBreaker.call (/usr/src/app/node_modules/opossum/lib/circuit.js:717:21)\n    at CircuitBreaker.fire (/usr/src/app/node_modules/opossum/lib/circuit.js:616:17)\n    at retry.retries (/usr/src/app/src/services/emailService.js:109:21)\n    at RetryOperation.runAttempt [as _fn] (/usr/src/app/node_modules/async-retry/lib/index.js:42:15)\n    at Timeout._onTimeout (/usr/src/app/node_modules/retry/lib/retry_operation.js:85:10)\n    at listOnTimeout (node:internal/timers:581:17)\n    at process.processTimers (node:internal/timers:519:7)","timestamp":"2025-06-28 04:43:01"}
{"level":"warn","message":"Email service circuit breaker half-open. Trying again...","timestamp":"2025-06-28 04:43:19"}
